!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("react"),require("react/addons"));else if("function"==typeof define&&define.amd)define(["react","react/addons"],t);else{var s="object"==typeof exports?t(require("react"),require("react/addons")):t(e.react,e["react/addons"]);for(var n in s)("object"==typeof exports?exports:e)[n]=s[n]}}(this,function(e,t){return function(e){function t(n){if(s[n])return s[n].exports;var o=s[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var s={};return t.m=e,t.c=s,t.p="",t(0)}([function(e,t,s){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var r=s(6),i=s(5),p=s(4),a=s(2);e.exports=r.createClass({displayName:"exports",propTypes:{tags:r.PropTypes.array,suggestions:r.PropTypes.oneOfType([r.PropTypes.array,r.PropTypes.func]),addKeys:r.PropTypes.array,removeKeys:r.PropTypes.array,upKey:r.PropTypes.number,downKey:r.PropTypes.number,onChange:r.PropTypes.func,onAdd:r.PropTypes.func,displayField:r.PropTypes.string},getDefaultProps:function(){return{tags:[],addKeys:[13],removeKeys:[46,8],upKey:38,downKey:40,onChange:function(){},displayField:"value"}},getInitialState:function(){return{tag:"",tags:this.props.tags,dropdownItems:[],inputWidth:50,selectedDropdownIndex:-1}},removeTag:function(e){for(var t=[].concat(n(this.state.tags)),s=0;s<t.length;s++)if(t[s]===e)return t.splice(s,1),this.setState({tags:t}),void this.props.onChange(t,this.state.tags)},addTag:function(e){function t(e){var t=r.addons.update(this.state.tags,{$push:[e]});this.setState({tags:t,tag:"",selectedDropdownIndex:-1,dropdownItems:[]}),this.calculateInputWidth(1),this.props.onChange(t,this.state.tags)}var s=this,n="string"==typeof e?e.trim():e[this.props.displayField];if(0!==n.length){var i=o({},this.props.displayField,n);"function"==typeof this.props.onAdd?this.props.onAdd(i,this.state.tags).then(function(e){t.bind(s,e)()}):t.bind(this,i)()}},addSuggestion:function(e){this.addTag(this.state.dropdownItems[e])},onInputChange:function(e){this.setState({tag:e.target.value,selectedDropdownIndex:-1}),this.calculateInputWidth(e.target.value.length),this.getSuggestions(e.target.value)},onInputKeyDown:function(e){-1!==this.props.addKeys.indexOf(e.keyCode)&&(-1===this.state.selectedDropdownIndex?this.addTag(this.state.tag):this.addTag(this.state.dropdownItems[this.state.selectedDropdownIndex])),-1!==this.props.removeKeys.indexOf(e.keyCode)&&0===this.refs.input.getDOMNode().selectionStart&&this.removeTag(this.state.tags[this.state.tags.length-1]),this.props.downKey===e.keyCode&&(e.preventDefault(),this.selectDropdownItem("down")),this.props.upKey===e.keyCode&&(e.preventDefault(),this.selectDropdownItem("up"))},onClick:function(e){"tag-filter"===e.target.className&&this.refs.input.getDOMNode().focus()},calculateInputWidth:function(e){var t=12*e,s=this.refs.container.getDOMNode().offsetWidth-20;this.setState({inputWidth:t>s?s:t})},selectDropdownItem:function(e){var t=this.state.selectedDropdownIndex;"down"===e&&t<this.state.dropdownItems.length-1&&t++,"up"===e&&t>0&&t--,this.setState({selectedDropdownIndex:t})},getSuggestions:function(e){var t=this,s=e.toLowerCase(),n=typeof this.props.suggestions;if("object"===n){var o=this.props.suggestions.filter(function(e){return"string"==typeof e?e.toLowerCase().indexOf(s)>-1:e.value.toLowerCase().indexOf(s)>-1}),r=o.sort(function(t,n){var o="string"==typeof t?t:t.value,r="string"==typeof n?n:n.value;return o.toLowerCase().indexOf(s)>=r.toLowerCase().indexOf(e)});this.setState({dropdownItems:r})}"function"===n&&this.props.suggestions(e).then(function(e){t.setState({dropdownItems:e})}.bind(this))},getClasses:function(){return this.state.tag.length>1&&this.state.dropdownItems&&this.state.dropdownItems.length>0?"dropdown-open":"dropdown-closed"},render:function(){var e=this,t=this.state.tags.map(function(t,s){return r.createElement(i,{key:s,tag:t,remove:e.removeTag.bind(null,t),displayField:e.props.displayField})}.bind(this));return r.createElement("div",{className:"tag-filter-container "+this.getClasses()},r.createElement("div",{className:"tag-filter",ref:"container",onClick:this.onClick},t,r.createElement(p,{ref:"input",value:this.state.tag,inputWidth:this.state.inputWidth,onChange:this.onInputChange,onKeyDown:this.onInputKeyDown})),r.createElement(a,{items:this.state.dropdownItems,selectedIndex:this.state.selectedDropdownIndex,onSelect:this.addSuggestion}))}})},function(t,s){t.exports=e},function(e,t,s){"use strict";var n=s(1),o=s(3);e.exports=n.createClass({displayName:"exports",propTypes:{items:n.PropTypes.array,selectedIndex:n.PropTypes.number,onSelect:n.PropTypes.func,displayField:n.PropTypes.string},render:function(){var e=this,t=[];return this.props.items&&(t=this.props.items.map(function(t,s){var r="string"==typeof t?t:t[e.props.displayField];return n.createElement(o,{text:r,isSelected:e.props.selectedIndex===s,onSelect:e.props.onSelect.bind(null,s)})}.bind(this))),n.createElement("div",{className:"tag-filter-dropdown"},t)}})},function(e,t,s){"use strict";var n=s(1);e.exports=n.createClass({displayName:"exports",propTypes:{text:n.PropTypes.string,isSelected:n.PropTypes.bool,onSelect:n.PropTypes.func},render:function(){var e=this.props.isSelected?"selected":"";return n.createElement("div",{className:"tag-filter-dropdown-item "+e,onClick:this.props.onSelect},this.props.text)}})},function(e,t,s){"use strict";var n=s(1);e.exports=n.createClass({displayName:"exports",propTypes:{inputWidth:n.PropTypes.number,value:n.PropTypes.oneOfType([n.PropTypes.object,n.PropTypes.string]),onChange:n.PropTypes.func,onKeyDown:n.PropTypes.func},render:function(){return n.createElement("input",{className:"tag-filter-input",style:{width:this.props.inputWidth},value:this.props.value,onChange:this.props.onChange,onKeyDown:this.props.onKeyDown})}})},function(e,t,s){"use strict";var n=s(1);e.exports=n.createClass({displayName:"exports",propTypes:{tag:n.PropTypes.oneOfType([n.PropTypes.string,n.PropTypes.object]),selected:n.PropTypes.bool,remove:n.PropTypes.func,displayField:n.PropTypes.string},render:function(){var e=this.props.selected===!0?"selected":"",t="string"==typeof tag?this.props.tag:this.props.tag[this.props.displayField];return n.createElement("span",{className:"tag-filter-node "+e},t,n.createElement("a",{className:"fa fa-times tag-filter-node-remove",href:"javascript:;",onClick:this.props.remove}))}})},function(e,s){e.exports=t}])});